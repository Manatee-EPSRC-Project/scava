<?nsuri org.eclipse.scava.crossflow?>
<?render-graphviz-dot ../../org.eclipse.scava.crossflow.tests/models/graphviz.egl?>
<_>
	
	<!-- Example counting the committer count of the most popular Java projects on Github -->
	<workflow name="GhTopSearchWorkflow" package="org.eclipse.scava.crossflow.examples.github.topsearch">
	
		<!-- csv source of Github top search result projects (owner/repo) -->
		<csvsource name="GhTopSearchCsvSource" out="GhTopSearchRepos" path="data/repos.csv"/>
		
		<!-- queue of Github top search repos -->
		<queue name="GhTopSearchRepos" type="OwnerRepoTuple"/> 
				
	 	<!-- task for cloning repositories retrieved from GitHub API -->
		<task name="GhTopSearchRepoCloner" in="GhTopSearchRepos" out="GhTopSearchClonedRepoEntries"/> 
				
		<!-- queues of repositories cloned from GitHub -->
		<queue name="GhTopSearchClonedRepoEntries" type="OwnerRepoUrlTuple"/>
		
		<!-- tasks for counting unique authors of repositories cloned from GitHub -->
		<task name="GhTopSearchRepoAuthorCounter" in="GhTopSearchClonedRepoEntries" out="OwnerRepoAuthorCountEntries"/>
		
		<!-- queues of unique author count of repositories cloned from GitHub  -->
		<queue name="OwnerRepoAuthorCountEntries" type="OwnerRepoAuthorCountTuple"/> 
		
		<!-- csv sink for printing unique author count of repositories cloned from GitHub -->
		<csvsink name="GhTopSearchRepoAuthorCountCsvSink" in="OwnerRepoAuthorCountEntries" path="data/repos-authorCount.csv"/>
				
		<!-- Github JavaProjects: github owner/repo -->
		<type name="OwnerRepoTuple">
			<field name="repoOwner" type="String"/>
			<field name="repoRemote" type="String"/>
		</type>
		
		<!-- GhTopSearchClonedRepoEntries: github owner/repo, repo remote URL, repo local path -->
		<type name="OwnerRepoUrlTuple">
			<field name="repoOwner" type="String"/>
			<field name="repoRemote" type="String"/>
			<field name="repoLocal" type="String"/>
		</type>
		
		<!-- github owner/repo, repo remote URL, count -->
		<type name="OwnerRepoAuthorCountTuple">
			<field name="repoOwner" type="String"/>
			<field name="repoRemote" type="String"/>
			<field name="authorCount" type="Integer"/> <!-- unique author count -->
		</type>
		
	</workflow>	
	
</_>